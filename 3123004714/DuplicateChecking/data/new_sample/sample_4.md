# 样本4：段落重组（相似度约70-75%）

## 进程管理

### PCB

为了方便管理，操作系统给每个资源和每个进程都建立了对应数据结构。**进程控制块（Process Control Block，PCB）**就是进程对应的数据结构。

其包含的信息一般有：

- 进程标识符。给每个进程一个唯一的名字
- 处理机状态。也称处理机上下文，在进程切换时保存信息，在进程重新执行后能从断点处开始
- 进程调度信息。OS 调度时需要参考的信息，如进程状态、进程优先级等等
- 进程控制信息。包括程序和数据的地址、资源清单（已分配和待分配）、链接指针（下一个PCB的位置）等

### 定义及特征

系统用进程控制块（Process Control Block，PCB）来描述进程的基本情况和活动过程。进程有多种定义，可以被理解为程序的运行过程，相当于程序段+数据段+执行中+PCB，它是系统进行资源分配和调度的一个基本单位。

进程还具有以下特征：

- 动态性：进程的实质是进程实体的执行过程
- 并发性：多个进程实体可以同时存在内存中，且能并发运行
- 独立性：进程实体是一个能独立运行、独立获取资源、独立接受调度的基本单位
- 异步性：

### 并发执行

程序的并发执行。多道程序环境下，多个程序的执行是并发执行，由于共享资源、操作系统的异步特性等，可能导致程序执行的先后顺序颠倒，最终结果不可复现。进程的一大意义便在此——进程虽在并发执行时具有异步性，但仍能保证其结果是可再现的。

### 进程状态及转换

多个进程共享系统资源，使得他们间断性运行，具有多种不同的状态。

#### 三种基本状态及其转换

一般而言，每一种进程至少处于以下三种状态之一：

- 就绪 Ready 状态。进程只要得到CPU就能立刻执行
- 执行 Running 状态。进程正在执行
- 阻塞 Block 状态。正在执行的进程由于某事件（如 I/O 请求）而暂时无法执行，此时处理机会被分配给另一个进程

进程在运行过程中进程会发生状态转换，如就绪进程被分配处理机后进入就绪状态，运行进程在时间片结束后仍未完成则重回就绪状态。

#### 创建状态和终止状态

创建进程需要多个步骤，第一步可以是申请空白PCB，随后分配资源等等。引入创建状态是为了保证进程的调度必须在创建工作全部完成后。这个状态也增加了管理的灵活性，OS 可以根据系统性能等原因推迟新进程的创建。

进程的中止首先要由操作系统善后处理，才能删除PCB。进入终止态的进程不能再执行，但仍可保留一些信息供其他进程收集使用。

### 进程控制

进程控制，可以理解为实现进程状态转化，一般由OS内核完成。

#### 进程的创建

OS调用 `Creat`原语按照下述步骤创建一个进程：

1. 申请空白 PCB
2. 为新进程分配其所需的资源
3. 初始化 PCB
4. 如果进程就绪队列能够接纳新进程，就进入进程就绪队列

能引起进程创建的事件有：

- 用户登录
- 作业调度
- 提供服务。如用户要求打印文件
- 应用请求。用户进程申请创建子进程，而上述三种都是由系统内核为用户创建进程

#### 进程的终止

当系统中发生了要求终止进程的事件（正常结束、异常结束、外界干预），OS 调用 终止原语，按照下述步骤终止一个进程：

1. 根据该进程的标识符检索出该进程的 PCB，读出其状态
2. 若该进程处于执行状态，立即中止该进程的执行
3. 若该进程还有子孙进程，则将其子孙进程予以终止
4. 被终止进程的全部资源归还给其父进程或系统
5. 移除该进程的 PCB

### 进程同步与进程互斥

在多道程序中，为了让多个进程能按照一定的规则共享系统资源和协同进程间的工作次序，必须引入进程同步机制，保证程序执行的正确性和可再现性。

常用的方法有硬件同步机制、信号量机制、管程机制等。

#### 基本概念

两种形式的制约关系：

1. 间接相互制约关系。进程间共享系统资源（I/O 设备）
2. 直接相互制约关系

临界资源：在一段时间内只允许一个进程访问，如打印机。进程应该采用互斥方式实现对该资源的共享。

同步机制应遵循的规则：

1. 空闲让进。
2. 忙则等待。
3. 有限等待。
4. 让权等待。当进程不能进入自己的临界区，应该释放处理机